(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[33],{5806:function(e,t,n){"use strict";n.r(t);var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("q-page",[n("q-card",[n("q-card-actions",{attrs:{align:"left"}},[n("q-btn",{directives:[{name:"go-back",rawName:"v-go-back.single",modifiers:{single:!0}}],staticStyle:{width:"150px"},attrs:{color:"red",icon:"reply",label:"ត្រឡប់ក្រោយ"}},[n("q-tooltip",{attrs:{"content-class":"bg-white text-primary"}},[e._v("ថយក្រោយ")])],1)],1),n("q-card-section",[n("q-img",{staticStyle:{height:"200px","max-width":"200px"},attrs:{src:e.data.hostname+e.data.photo}},[n("div",{staticClass:"absolute-bottom text-right no-padding"},[n("q-btn",{attrs:{icon:"edit",label:"កែប្រែ",flat:""}},[n("q-popup-edit",{model:{value:e.photo_prev,callback:function(t){e.photo_prev=t},expression:"photo_prev"}},[n("q-file",{staticStyle:{width:"300px"},attrs:{label:"ជ្រើសរើសរូបភាព",outlined:"",square:"",accept:"image/*",dense:"","lazy-rules":"",rules:[function(e){return!!e||"សូមជ្រើសរើស"}]},on:{input:e.photoFn},scopedSlots:e._u([{key:"prepend",fn:function(){return[n("q-icon",{attrs:{name:"attach_file"}})]},proxy:!0}]),model:{value:e.photo_prev,callback:function(t){e.photo_prev=t},expression:"photo_prev"}})],1)],1)],1)]),n("q-table",{attrs:{title:"ព័ត៌មានទូទៅ",data:e.personal_data,columns:e.columns_default,"rows-per-page-options":[0],"hide-bottom":""},scopedSlots:e._u([{key:"body",fn:function(t){return[n("q-tr",{attrs:{props:t}},[n("q-td",{key:"kh_name",attrs:{props:t}},[e._v("\n              "+e._s(t.row.kh_name)+"\n              "),n("q-popup-edit",{scopedSlots:e._u([{key:"default",fn:function(a){var o=a.initialValue,r=a.value,i=(a.emitValue,a.validate,a.set),l=a.cancel;return[n("q-input",{attrs:{dense:"",autofocus:""},on:{keyup:function(t){if(!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter"))return null;t.stopPropagation()}},scopedSlots:e._u([{key:"after",fn:function(){return[n("q-btn",{attrs:{flat:"",dense:"",color:"negative",icon:"cancel"},on:{click:function(e){return e.stopPropagation(),l(e)}}}),n("q-btn",{attrs:{flat:"",dense:"",color:"positive",icon:"check_circle",disable:o===r},on:{click:[function(e){return e.stopPropagation(),i(e)},function(n){return e.updatePatient({id:e.data._id,data:{kh_name:t.row.kh_name}})}]}})]},proxy:!0}],null,!0),model:{value:t.row.kh_name,callback:function(n){e.$set(t.row,"kh_name",n)},expression:"props.row.kh_name"}})]}}],null,!0),model:{value:t.row.kh_name,callback:function(n){e.$set(t.row,"kh_name",n)},expression:"props.row.kh_name"}})],1),n("q-td",{key:"lt_name",attrs:{props:t}},[e._v("\n              "+e._s(t.row.lt_name)+"\n              "),n("q-popup-edit",{scopedSlots:e._u([{key:"default",fn:function(a){var o=a.initialValue,r=a.value,i=(a.emitValue,a.validate,a.set),l=a.cancel;return[n("q-input",{attrs:{dense:"",autofocus:""},on:{keyup:function(t){if(!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter"))return null;t.stopPropagation()}},scopedSlots:e._u([{key:"after",fn:function(){return[n("q-btn",{attrs:{flat:"",dense:"",color:"negative",icon:"cancel"},on:{click:function(e){return e.stopPropagation(),l(e)}}}),n("q-btn",{attrs:{flat:"",dense:"",color:"positive",icon:"check_circle",disable:o===r},on:{click:[function(e){return e.stopPropagation(),i(e)},function(n){return e.updatePatient({id:e.data._id,data:{lt_name:t.row.lt_name}})}]}})]},proxy:!0}],null,!0),model:{value:t.row.lt_name,callback:function(n){e.$set(t.row,"lt_name",n)},expression:"props.row.lt_name"}})]}}],null,!0),model:{value:t.row.lt_name,callback:function(n){e.$set(t.row,"lt_name",n)},expression:"props.row.lt_name"}})],1),n("q-td",{key:"gender",attrs:{props:t}},[e._v("\n              "+e._s(t.row.gender)+"\n              "),n("q-popup-edit",{scopedSlots:e._u([{key:"default",fn:function(a){var o=a.initialValue,r=a.value,i=(a.emitValue,a.validate,a.set),l=a.cancel;return[n("q-select",{attrs:{outlined:"",label:"ភេទ",options:["ប្រុស","ស្រី"],square:""},on:{keyup:function(t){if(!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter"))return null;t.stopPropagation()}},scopedSlots:e._u([{key:"after",fn:function(){return[n("q-btn",{attrs:{flat:"",dense:"",color:"negative",icon:"cancel"},on:{click:function(e){return e.stopPropagation(),l(e)}}}),n("q-btn",{attrs:{flat:"",dense:"",color:"positive",icon:"check_circle",disable:o===r},on:{click:[function(e){return e.stopPropagation(),i(e)},function(n){return e.updatePatient({id:e.data._id,data:{gender:t.row.gender}})}]}})]},proxy:!0}],null,!0),model:{value:t.row.gender,callback:function(n){e.$set(t.row,"gender",n)},expression:"props.row.gender"}})]}}],null,!0),model:{value:t.row.gender,callback:function(n){e.$set(t.row,"gender",n)},expression:"props.row.gender"}})],1),n("q-td",{key:"age",attrs:{props:t}},[e._v("\n              "+e._s(t.row.age)+"\n              "),n("q-popup-edit",{scopedSlots:e._u([{key:"default",fn:function(a){var o=a.initialValue,r=a.value,i=(a.emitValue,a.validate,a.set),l=a.cancel;return[n("q-input",{attrs:{dense:"",autofocus:""},on:{keyup:function(t){if(!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter"))return null;t.stopPropagation()}},scopedSlots:e._u([{key:"after",fn:function(){return[n("q-btn",{attrs:{flat:"",dense:"",color:"negative",icon:"cancel"},on:{click:function(e){return e.stopPropagation(),l(e)}}}),n("q-btn",{attrs:{flat:"",dense:"",color:"positive",icon:"check_circle",disable:o===r},on:{click:[function(e){return e.stopPropagation(),i(e)},function(n){return e.updatePatient({id:e.data._id,data:{age:t.row.age}})}]}})]},proxy:!0}],null,!0),model:{value:t.row.age,callback:function(n){e.$set(t.row,"age",n)},expression:"props.row.age"}})]}}],null,!0),model:{value:t.row.age,callback:function(n){e.$set(t.row,"age",n)},expression:"props.row.age"}})],1),n("q-td",{key:"phone",attrs:{props:t}},[e._v("\n              "+e._s(t.row.phone)+"\n              "),n("q-popup-edit",{scopedSlots:e._u([{key:"default",fn:function(a){var o=a.initialValue,r=a.value,i=(a.emitValue,a.validate,a.set),l=a.cancel;return[n("q-input",{attrs:{dense:"",autofocus:""},on:{keyup:function(t){if(!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter"))return null;t.stopPropagation()}},scopedSlots:e._u([{key:"after",fn:function(){return[n("q-btn",{attrs:{flat:"",dense:"",color:"negative",icon:"cancel"},on:{click:function(e){return e.stopPropagation(),l(e)}}}),n("q-btn",{attrs:{flat:"",dense:"",color:"positive",icon:"check_circle",disable:o===r},on:{click:[function(e){return e.stopPropagation(),i(e)},function(n){return e.updatePatient({id:e.data._id,data:{phone:t.row.phone}})}]}})]},proxy:!0}],null,!0),model:{value:t.row.phone,callback:function(n){e.$set(t.row,"phone",n)},expression:"props.row.phone"}})]}}],null,!0),model:{value:t.row.phone,callback:function(n){e.$set(t.row,"phone",n)},expression:"props.row.phone"}})],1)],1)]}}])})],1),n("q-card-section",[n("q-table",{attrs:{title:"អាស័យដ្ឋាន",data:e.address_data,columns:e.columns_address,"rows-per-page-options":[0],"hide-bottom":""},scopedSlots:e._u([{key:"body",fn:function(t){return[n("q-tr",{attrs:{props:t}},[n("q-td",{key:"type",attrs:{props:t}},[e._v("\n              "+e._s(t.row.type)+"\n            ")]),n("q-td",{key:"province",attrs:{props:t}},[e._v("\n              "+e._s(t.row.province)+"\n            ")]),n("q-td",{key:"district",attrs:{props:t}},[e._v("\n              "+e._s(t.row.district)+"\n            ")]),n("q-td",{key:"commune",attrs:{props:t}},[e._v("\n              "+e._s(t.row.commune)+"\n            ")]),n("q-td",{key:"village",attrs:{props:t}},[e._v("\n              "+e._s(t.row.village)+"\n            ")]),n("q-td",{key:"_id",attrs:{props:t}},[n("q-btn",{attrs:{dense:"",round:"",flat:"",color:"primary",icon:"edit"}}),n("q-popup-edit",{attrs:{validate:function(e){return!!e}},scopedSlots:e._u([{key:"default",fn:function(a){var o=a.initialValue,r=a.value,i=(a.emitValue,a.validate),l=a.set,s=a.cancel;return[n("q-select",{attrs:{"use-input":"",outlined:"",label:"ជ្រើសរើស អាស័យដ្ឋាន",options:e.optionsAddressBook,square:""},on:{filter:e.filterFnAddressBook},scopedSlots:e._u([{key:"after",fn:function(){return[n("q-btn",{attrs:{flat:"",dense:"",color:"negative",icon:"cancel"},on:{click:function(e){return e.stopPropagation(),s(e)}}}),n("q-btn",{attrs:{flat:"",dense:"",color:"positive",icon:"check_circle",disable:!1===i(r)||o===r},on:{click:[function(e){return e.stopPropagation(),l(e)},function(n){return e.updatePatient({id:e.data._id,data:{current_address_book:t.row._id.value}})}]}})]},proxy:!0}],null,!0),model:{value:t.row._id,callback:function(n){e.$set(t.row,"_id",n)},expression:"props.row._id"}})]}}],null,!0),model:{value:t.row._id,callback:function(n){e.$set(t.row,"_id",n)},expression:"props.row._id"}})],1)],1)]}}])})],1)],1)],1)},o=[],r=[{align:"left",name:"kh_name",label:"នាមត្រកូល",field:"kh_name"},{align:"left",name:"lt_name",label:"នាមខ្លួន",field:"lt_name"},{align:"left",name:"gender",label:"ភេទ",field:"gender"},{align:"left",name:"age",label:"ថ្ងៃខែឆ្នាំកំណើត",field:"age"},{align:"left",name:"phone",label:"លេខទូរសព្ទ",field:"phone"}],i=[{align:"left",name:"province",label:"ខេត្ត/ក្រុង",field:"province"},{align:"left",name:"district",label:"ស្រុក/ខណ្ឌ",field:"district"},{align:"left",name:"commune",label:"ឃំុ/សង្កាត់",field:"commune"},{align:"left",name:"village",label:"ភូមិ",field:"village"},{align:"left",name:"_id",label:"កែប្រែ",field:"_id"}],l={name:"PatientEdit",data:function(){return{dataPhoto:new FormData,columns_default:r,columns_address:i,photo_prev:null,personal_data:[],address_data:[],optionsAddressBook:[],data:{_id:null,current_address_book:[],age:"14/06/2020",facebook:"Nak Vanna",flatin:"Vanna",gender:"ប្រុស",hostname:"http://localhost:3000/",kh_name:"ណាក់ វណ្ណា",phone:"5656645235",photo:"files/patients-icon-7.jpg"}}},computed:{getAddressBooks:function(){return this.$store.getters["address_book/getAddressBook"].map((function(e){return{value:e._id,label:"".concat(e.province," - ").concat(e.district," - ").concat(e.commune," - ").concat(e.village)}}))}},created:function(){var e=this,t=e.data;e.$store.dispatch("patient/editPatient",e.$route.params.id).then((function(n){t._id=n.data._id,t.current_address_book=n.data.current_address_book,t.age=n.data.age,t.contact=n.data.contact,t.facebook=n.data.facebook,t.lt_name=n.data.lt_name,t.gender=n.data.gender,t.kh_name=n.data.kh_name,t.phone=n.data.phone,t.photo=n.data.photo,t.tel=n.data.tel,t.telegram=n.data.telegram,e.personal_data=[],e.personal_data.push(n.data),e.address_data=[];var a=n.data.current_address_book;e.address_data.push({type:"អាស័យដ្ឋានបច្ចុប្បន្ន",_id:{value:a._id,label:"".concat(a.province," - ").concat(a.district," - ").concat(a.commune," - ").concat(a.village)},province:a.province,district:a.district,commune:a.commune,village:a.village})}))},methods:{photoFn:function(e){var t=this;t.dataPhoto.set("id",t.data._id),t.dataPhoto.set("photo",e);var n=new FileReader;n.readAsDataURL(e),n.onload=function(){t.data.photo=n.result,t.data.hostname=""},t.updatePatientFile(t.dataPhoto)},filterFnAddressBook:function(e,t,n){var a=this;t((function(){var t=e.toLowerCase();a.optionsAddressBook=a.getAddressBooks.filter((function(e){return e.label.toLowerCase().indexOf(t)>-1}))}))},updatePatient:function(e){var t=this;t.$store.dispatch("patient/updatePatient",e).then((function(e){e.status?t.$q.notify({color:"green-4",textColor:"white",icon:"cloud_done",message:e.message}):t.$q.notify({color:"red-5",textColor:"white",icon:"warning",message:e.message})}))},updatePatientFile:function(e){var t=this;e.set("id",t.data._id),t.$store.dispatch("patient/updatePatientThumbnail",e).then((function(e){e.status?t.$q.notify({color:"green-4",textColor:"white",icon:"cloud_done",message:e.message}):t.$q.notify({color:"red-5",textColor:"white",icon:"warning",message:e.message})}))}}},s=l,c=n("2877"),d=n("eebe"),u=n.n(d),p=n("9989"),f=n("f09f"),_=n("4b7e"),k=n("9c40"),m=n("05c0"),g=n("a370"),v=n("068f"),h=n("42a1"),b=n("7d53"),w=n("0016"),y=n("eaac"),q=n("bd08"),x=n("db86"),P=n("27f9"),$=n("ddd8"),S=n("2eeb"),C=Object(c["a"])(s,a,o,!1,null,"3c90ce78",null);t["default"]=C.exports;u()(C,"components",{QPage:p["a"],QCard:f["a"],QCardActions:_["a"],QBtn:k["a"],QTooltip:m["a"],QCardSection:g["a"],QImg:v["a"],QPopupEdit:h["a"],QFile:b["a"],QIcon:w["a"],QTable:y["a"],QTr:q["a"],QTd:x["a"],QInput:P["a"],QSelect:$["a"]}),u()(C,"directives",{GoBack:S["a"]})}}]);